<app-navbar></app-navbar>

<div class="agendamentos-container">
  <div class="container">
    <div class="page-header">
      <h1>Meus Agendamentos</h1>
      <button class="btn btn-primary" (click)="novoAgendamento()">
        âž• Novo Agendamento
      </button>
    </div>

    <div class="gold-divider"></div>

    @if (erro) {
      <div class="alert alert-danger">
        {{ erro }}
      </div>
    }

    @if (sucesso) {
      <div class="alert alert-success">
        {{ sucesso }}
      </div>
    }

    @if (carregando) {
      <div class="loading text-center">
        <p>Carregando agendamentos...</p>
      </div>
    } @else {
      @if (agendamentos.length === 0) {
        <div class="empty-state card text-center">
          <h2>Nenhum agendamento encontrado</h2>
          <p>VocÃª ainda nÃ£o possui agendamentos. Que tal fazer um agora?</p>
          <button class="btn btn-primary mt-2" (click)="novoAgendamento()">
            Agendar Agora
          </button>
        </div>
      } @else {
        <div class="agendamentos-list">
          @for (agendamento of agendamentos; track agendamento.id) {
            <div class="card agendamento-card">
              <div class="agendamento-header">
                <div>
                  <h3>{{ agendamento.servico_nome }}</h3>
                  <p class="data">ðŸ“… {{ formatarData(agendamento.data_hora) }}</p>
                </div>
                <span class="status-badge" [ngClass]="getStatusClass(agendamento.status || '')">
                  {{ getStatusLabel(agendamento.status || '') }}
                </span>
              </div>

              <div class="agendamento-body">
                <div class="info-grid">
                  @if (authService.isAdmin() && agendamento.usuario_nome) {
                    <div class="info-item">
                      <span class="label">Cliente:</span>
                      <span class="value">{{ agendamento.usuario_nome }}</span>
                    </div>
                  }
                  <div class="info-item">
                    <span class="label">ServiÃ§o:</span>
                    <span class="value">{{ agendamento.servico_nome }}</span>
                  </div>
                  <div class="info-item">
                    <span class="label">DuraÃ§Ã£o:</span>
                    <span class="value">{{ agendamento.servico_duracao }} minutos</span>
                  </div>
                  <div class="info-item">
                    <span class="label">Valor:</span>
                    <span class="value preco">R$ {{ formatarPreco(agendamento.servico_preco) }}</span>
                  </div>
                </div>

                @if (agendamento.observacoes) {
                  <div class="observacoes">
                    <strong>ObservaÃ§Ãµes:</strong> {{ agendamento.observacoes }}
                  </div>
                }
              </div>

              @if (podeCancelar(agendamento.status || '') || podeDeletar(agendamento.status || '')) {
                <div class="agendamento-footer">
                  @if (podeCancelar(agendamento.status || '')) {
                    <button class="btn btn-secondary btn-sm" (click)="cancelarAgendamento(agendamento.id)">
                      Cancelar
                    </button>
                  }
                  @if (podeDeletar(agendamento.status || '')) {
                    <button class="btn btn-danger btn-sm" (click)="deletarAgendamento(agendamento.id)">
                      Deletar
                    </button>
                  }
                </div>
              }
            </div>
          }
        </div>
      }
    }
  </div>
</div>

